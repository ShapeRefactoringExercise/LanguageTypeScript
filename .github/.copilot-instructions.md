# Copilot Instructions

## Commit Message Guidelines

This project uses **Arlo's Commit Notation** (Risk-Aware Commit Notation) for all commits. Each commit message must start with a 3-character prefix that indicates both the risk level and intention of the change.

### Format: `[Risk Level][Intention] Description`

## Risk Levels

- `.` **Safe** - Proven safe, addresses all known and unknown risks
- `^` **Validated** - Addresses all known risks through testing or verification
- `!` **Risky** - Some known risks remain unverified
- `@` **Broken** - No risk attestation, may not compile or work

## Core Intentions

### t - Test Changes
- **t** (lowercase only) - Adding/removing tests or changing test architecture
- Intended to modify test structure beyond simple refactoring
- More substantial test changes that affect testing strategy or coverage

**Examples:**
- `. t Add comprehensive integration test suite` - Safe test addition (proven approach)
- `^ t Add unit tests for edge cases` - Validated test addition with verification
- `! t Restructure test organization` - Risky test architecture change
- `@ t Start adding performance test framework` - Broken/incomplete test work

### tr - Test Refactoring
- **tr** (lowercase only) - Refactoring existing tests without changing test behavior
- Intended to improve test code structure, readability, or maintainability
- Changes test implementation but not what is being tested

**Examples:**
- `. tr Extract test helper methods using IDE` - Safe test refactoring (automated)
- `^ tr Rename test methods for clarity` - Validated test refactoring
- `! tr Consolidate duplicate test setup code` - Risky test refactoring
- `@ tr Attempt to simplify complex test logic` - Broken/incomplete test refactoring

### F/f - Feature or Functionality
- **F** (uppercase) - User-visible feature change
- **f** (lowercase) - Internal/developer-only feature change
- Intended to change exactly 1 behavior

**Examples:**
- `. F Add user authentication system` - Safe feature (≤8 LoC, fully tested)
- `^ F Add email validation to signup form` - Validated feature with tests
- `! F Implement payment processing` - Risky feature with basic tests
- `@ F Start user profile feature` - Broken/incomplete feature

### B/b - Bugfix
- **B** (uppercase) - User-visible bug fix
- **b** (lowercase) - Internal/developer-only bug fix
- Intended to fix exactly 1 undesirable behavior

**Examples:**
- `. B Fix calculation error in tax calculator` - Safe bugfix (≤8 LoC, fully tested)
- `^ B Correct user input validation` - Validated bugfix with tests
- `! B Fix memory leak in data processor` - Risky bugfix with basic tests
- `@ B Attempt to fix login issue` - Broken/incomplete bugfix

### R/r - Refactoring
- **R** (uppercase) - Visible structural change (e.g., API changes)
- **r** (lowercase) - Internal code structure change
- Intended to change 0 runtime behaviors, improve code structure

**Examples:**
- `. r Extract method using IDE refactoring tool` - Safe refactoring (provable)
- `^ r Rename variables for clarity` - Validated refactoring with full test coverage
- `! r Restructure class hierarchy` - Risky refactoring with limited test coverage
- `@ r Attempt to extract complex method` - Broken/incomplete refactoring

### D/d - Documentation
- **D** (uppercase) - User-facing documentation
- **d** (lowercase) - Developer-facing documentation
- Intended to change 0 behaviors, only communication/documentation

**Examples:**
- `. d Update inline code comments` - Safe documentation (no compilation impact)
- `^ d Add API documentation with examples` - Validated documentation
- `! d Update README with new setup process` - Risky documentation (process change)
- `@ d Draft new architecture documentation` - Broken/incomplete documentation

## Guidelines for Risk Assessment

### Safe (.) Requirements:
- **Features/Bugs**: ≤8 lines of code, fully unit tested before and after
- **Refactoring**: Provable refactoring using automated tools or formal methods
- **Documentation**: No compilation or process impact
- **Test Changes**: Using established testing patterns with proven frameworks
- **Test Refactoring**: Automated refactoring tools or simple, obvious changes

### Validated (^) Requirements:
- **Features/Bugs**: Includes comprehensive tests for new behavior
- **Refactoring**: Named refactoring with full test coverage following published steps
- **Documentation**: Verified by running tests or compilation
- **Test Changes**: New tests verified to pass/fail appropriately, follow team standards
- **Test Refactoring**: Changes verified by running full test suite successfully

### Risky (!) Requirements:
- **Features/Bugs**: Includes basic tests but some risks remain
- **Refactoring**: Named refactoring but limited test coverage or manual execution
- **Documentation**: Basic verification only
- **Test Changes**: Tests added but may have coverage gaps or unclear assertions
- **Test Refactoring**: Manual changes with potential for breaking test behavior

### Broken (@) - Use when:
- Code doesn't compile or work yet
- Unfinished implementation
- Savepoint before switching tasks
- No verification performed

## Commit Message Examples

```
. r Extract calculateTax method using IDE
^ F Add input validation with comprehensive tests  
! B Fix race condition in user session handling
@ F Start implementing OAuth integration
^ d Add JSDoc comments for public API methods
. r Rename variables using automated refactoring
! F Add file upload feature with basic error handling
^ B Fix null pointer exception with proper test coverage
^ t Add unit tests for payment processing edge cases
. tr Extract common test setup into helper methods
! t Restructure test suite for better organization
@ tr Start refactoring complex integration tests
```

## Best Practices

1. **Keep commits small** - Aim for ≤8 lines of code for features/bugs to achieve higher safety levels
2. **One intention per commit** - Don't mix refactoring with features
3. **Write tests first** - Helps achieve `^` or `.` risk level
4. **Use automated tools** - IDE refactorings help achieve `.` risk level
5. **Be honest about risk** - Better to mark something `!` or `@` than claim false safety
6. **All tests must pass before commit** - Unless explicitly stated otherwise by the user, ensure all existing tests pass before committing any changes

## When in Doubt

- If you can't verify the change completely → use `!` or `@`
- If mixing multiple intentions → split into separate commits
- If changing >8 lines for features/bugs → use `!` risk level maximum
- If unsure about the intention → ask for clarification before committing

For more details, see: https://github.com/RefactoringCombos/ArlosCommitNotation